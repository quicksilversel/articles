---
title: 'Setting Up Dark Theme with Emotion & Next.js'
description: 'Set up a dark/light theme toggle in a NextJS app with Emotion, covering theme colors, user preferences, and a theme toggle button.'
topics: ['nextjs', 'emotion', 'css']
category: 'frontend'
published: true
date: '2024-07-21'
---

## Introduction

Adding a dark mode toggle is one of those features that feels magical and polished — and it’s easier than you might think using Emotion and Next.js ✨

In this guide, we’ll walk through:

- Defining light and dark theme colors
- Detecting system/user preferences
- Wrapping your app with `ThemeProvider`
- Creating a toggle button

Let’s dive in!

## 🎨 Define Theme Colors

Create a `themes.ts` file to manage your color palettes.

```ts
const commonTheme = {
  primary: 'hsl(245deg, 100%, 60%)',
}

export const darkTheme = {
  ...commonTheme,
  background: 'hsl(210deg, 30%, 8%)',
  text: 'hsl(0deg, 0%, 100%)',
}

export const lightTheme = {
  ...commonTheme,
  background: 'hsl(0deg, 0%, 100%)',
  text: 'hsl(222deg, 22%, 5%)',
}
```

> 💡 Tip: Stick to HSL for easier theming — it’s super intuitive when adjusting hue/lightness.

### 🧑‍💻 TypeScript Users: Define the Theme

Create a `theme.d.ts` file to extend Emotion's default theme:

```ts
import '@emotion/react'

declare module '@emotion/react' {
  export interface Theme {
    background: string
    text: string
    primary: string
  }
}
```

## 🧠 Detect User Preference

In your `_app.tsx`, set the theme based on:

- System preference (via `prefers-color-scheme`)
- User override from `localStorage`

```ts
useEffect(() => {
  const savedTheme = localStorage.getItem('theme')
  const prefersLight =
    window.matchMedia &&
    window.matchMedia('(prefers-color-scheme: light)').matches

  if (savedTheme) {
    setTheme(savedTheme === 'dark' ? 'dark' : 'light')
  } else if (prefersLight) {
    setTheme('light')
  }
}, [])
```

## 🔌 Add ThemeProvider in `_app.tsx`

Make sure your app is wrapped in both `ThemeProvider` and `CacheProvider` (from Emotion):

```tsx
import { useState, useEffect } from 'react'
import { ThemeProvider, CacheProvider } from '@emotion/react'
import { cache } from '@emotion/css'
import type { AppProps } from 'next/app'
import { lightTheme, darkTheme } from '@/components/Styles/themes'

export type ThemeContext = {
  theme: 'light' | 'dark'
  setTheme: (theme: 'light' | 'dark') => void
}

function MyApp({ Component, pageProps }: AppProps) {
  const [theme, setTheme] = useState<ThemeContext['theme']>('dark')

  useEffect(() => {
    const savedTheme = localStorage.getItem('theme')
    const prefersLight =
      window.matchMedia &&
      window.matchMedia('(prefers-color-scheme: light)').matches

    if (savedTheme) {
      setTheme(savedTheme === 'dark' ? 'dark' : 'light')
    } else if (prefersLight) {
      setTheme('light')
    }
  }, [])

  return (
    <CacheProvider value={cache}>
      <ThemeProvider theme={theme === 'dark' ? darkTheme : lightTheme}>
        <Component {...pageProps} />
        <ThemeToggler theme={theme} setTheme={setTheme} />
      </ThemeProvider>
    </CacheProvider>
  )
}

export default MyApp
```

## 🧪 Use Theme in Components

Now you can use the theme in styled components:

```tsx
import styled from '@emotion/styled'

const Text = styled.span`
  color: ${({ theme }) => theme.text};
`

export const MyComponent = () => {
  return <Text>Hello, theme world!</Text>
}
```

## 🔘 Add a Theme Toggle Button

Let’s make it easy for users to switch modes.

```tsx
import type { ThemeContext } from '@/pages/_app'

export const ThemeToggler = ({ theme, setTheme }: ThemeContext) => {
  const toggleTheme = () => {
    const newTheme = theme === 'light' ? 'dark' : 'light'
    setTheme(newTheme)
    localStorage.setItem('theme', newTheme)
  }

  return <button onClick={toggleTheme}>{theme === 'dark' ? '🌙' : '☀️'}</button>
}
```

Place it anywhere in your layout or inside `_app.tsx` as shown earlier.

## ✅ That’s It!

You now have a fully working light/dark theme in your Next.js app using Emotion. It respects system settings and user preferences, and it’s super easy to expand on.

Let me know if you want to add smooth transitions or theme-aware icons next! 🌗
